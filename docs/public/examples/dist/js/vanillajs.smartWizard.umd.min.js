(function(a,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(a=typeof globalThis<"u"?globalThis:a||self,a.SmartWizard=l())})(this,function(){"use strict";var I=a=>{throw TypeError(a)};var K=(a,l,s)=>l.has(a)||I("Cannot "+s);var p=(a,l,s)=>(K(a,l,"read from private field"),s?s.call(a):l.get(a)),f=(a,l,s)=>l.has(a)?I("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(a):l.set(a,s);var i=(a,l,s)=>(K(a,l,"access private method"),s);var l,s,k,$,P,G,M,J,Q,m,L,E,w,S,D,X,Y,A,g,b,y,_,H,B,R,j,v,Z,z,q,tt,st,et,it,C,W,V,nt,x;const F=class F{constructor(t,e){f(this,s);f(this,m,t=>{this.options.debug&&console.debug("Click on step "+t.currentTarget+"..."),t.preventDefault(),this.options.anchor.enableNavigation===!0&&i(this,s,_).call(this,t.currentTarget)&&i(this,s,b).call(this,Array.from(this.steps).indexOf(t.currentTarget))});f(this,L,t=>{this.options.debug&&console.debug("Click on element..."),t.target.classList.contains(this.options.style.btnNextCss)?(t.preventDefault(),i(this,s,g).call(this,"next")):t.target.classList.contains(this.options.style.btnPrevCss)&&(t.preventDefault(),i(this,s,g).call(this,"prev"))});f(this,E,t=>{this.options.debug&&console.debug("Keyup triggered..."),i(this,s,it).call(this,t)});f(this,w,t=>{if(this.options.debug&&console.debug("hashchange triggered..."),this.options.backButtonSupport!==!0)return;const e=i(this,s,V).call(this);e!==!1&&i(this,s,_).call(this,this.steps[e])&&(t.preventDefault(),i(this,s,b).call(this,e))});f(this,S,()=>{this.options.debug&&console.debug("Resize triggered..."),i(this,s,q).call(this,this.current_index)});f(this,D,()=>(this.options.debug&&console.debug("Submit triggered..."),i(this,s,P).call(this)));const n={debug:!1,initAtCreated:!0,selected:0,theme:"basic",justified:!0,requiredField:{active:!0,checkOnSubmitForm:!0,submitEvent:!1,controls:"input, textarea, select",classInvalid:"is-invalid",functionToValidate:null},autoAdjustHeight:!0,backButtonSupport:!0,enableUrlHash:!0,transition:{animation:"fade",speed:400,easing:"",prefixCss:"",fwdShowCss:"",fwdHideCss:"",bckShowCss:"",bckHideCss:""},toolbar:{position:"bottom",showNextButton:!0,showPreviousButton:!0,extraHtml:""},anchor:{enableNavigation:!0,enableNavigationAlways:!1,enableDoneState:!0,markPreviousStepsAsDone:!0,unDoneOnBackNavigation:!1,enableDoneStateNavigation:!0},keyboard:{keyNavigation:!0,keyLeft:[37],keyRight:[39]},lang:{next:"Next",previous:"Previous"},style:{mainCss:"sw",navCss:"nav",navLinkCss:"nav-link",contentCss:"sw-content",contentPanelCss:"sw-panel",themePrefixCss:"sw-theme-",anchorDefaultCss:"sw-default",anchorDoneCss:"sw-done",anchorActiveCss:"sw-active",anchorDisabledCss:"sw-disabled",anchorHiddenCss:"sw-hidden",anchorErrorCss:"sw-error",anchorWarningCss:"sw-warning",justifiedCss:"sw-justified",btnCss:"sw-btn",btnNextCss:"sw-btn-next",btnPrevCss:"sw-btn-prev",loaderCss:"sw-loading",progressCss:"progress",progressBarCss:"progress-bar",toolbarCss:"toolbar",toolbarPrefixCss:"toolbar-"},disabledSteps:[],errorSteps:[],warningSteps:[],hiddenSteps:[],getContent:null},o=(r,h)=>{if(typeof r=="object"&&r!==null&&typeof h=="object"&&h!==null){const c={...r};for(const u in h)Object.prototype.hasOwnProperty.call(h,u)&&(c[u]=o(c[u],h[u]));return c}return h};this.options=o(n,e),this.element=typeof t=="string"?document.querySelector(t):t,this.nav=i(this,s,M).call(this,`.${this.options.style.navCss}`),this.container=i(this,s,M).call(this,`.${this.options.style.contentCss}`),this.steps=Array.from(this.nav.querySelectorAll(`.${this.options.style.navLinkCss}`)),this.pages=Array.from(this.container.querySelectorAll(`.${this.options.style.contentPanelCss}`)),this.progressbar=this.element.querySelector(`.${this.options.style.progressCss}`),this.dir=i(this,s,J).call(this),this.current_index=-1,this.is_init=!1,this.searchFormClosest=null,this.options.initAtCreated&&i(this,s,k).call(this).then(()=>{i(this,s,$).call(this)})}goToStep(t,e){e=e!==!1,!(e!==!0&&!i(this,s,_).call(this,this.steps[t]))&&(e===!0&&t>0&&this.options.anchor.enableDoneState&&this.options.anchor.markPreviousStepsAsDone&&this.steps.slice(0,t).forEach(n=>n.classList.add(this.options.style.anchorDoneCss)),i(this,s,b).call(this,t))}next(){i(this,s,g).call(this,"next")}prev(){i(this,s,g).call(this,"prev")}reset(){this.steps.forEach(t=>t.classList.remove(this.options.style.anchorDoneCss,this.options.style.anchorActiveCss,this.options.style.anchorErrorCss,this.options.style.anchorWarningCss)),i(this,s,W).call(this,"#"),i(this,s,k).call(this).then(()=>{i(this,s,$).call(this)})}setState(t,e){i(this,s,x).call(this,t,e,!0)}unsetState(t,e){i(this,s,x).call(this,t,e,!1)}unsetErrors(t){i(this,s,x).call(this,null,"error",!1,t)}setOptions(t){this.options={...this.options,...t},i(this,s,k).call(this).then()}getOptions(){return this.options}getStepInfo(){return{currentStep:this.current_index!==null?this.current_index:0,totalSteps:this.steps?this.steps.length:0}}loader(t){this.element.classList.toggle(this.options.style.loaderCss,t==="show")}fixHeight(){i(this,s,q).call(this,this.current_index)}init(){i(this,s,k).call(this).then(()=>{i(this,s,$).call(this)})}checkStepRequired(t){return i(this,s,P).call(this,!0,t)}checkFormRequireds(){return i(this,s,P).call(this)}destroy(){this.steps.forEach(t=>{t.removeEventListener("click",p(this,m))}),this.element.removeEventListener("click",p(this,L)),document.removeEventListener("keyup",p(this,E)),window.removeEventListener("hashchange",p(this,w)),window.removeEventListener("resize",p(this,S)),this.searchFormClosest&&this.searchFormClosest.removeEventListener("submit",p(this,D)),this.options.debug&&console.log("Events destroyed. The object is no longer active.")}};l=new WeakMap,s=new WeakSet,k=async function(){return this.options.debug&&console.debug("Triggered init() method..."),i(this,s,Q).call(this),i(this,s,Y).call(this),this.is_init||(i(this,s,X).call(this),this.is_init=!0,i(this,s,C).call(this,"initialized")),!0},$=function(){this.options.debug&&console.debug("Triggered load() method..."),this.pages.forEach(n=>n.style.display="none"),this.steps.forEach(n=>n.classList.remove(this.options.style.anchorDoneCss,this.options.style.anchorActiveCss)),this.current_index=-1;let t=i(this,s,V).call(this);t=t!==!1?t:this.options.selected;const e=i(this,s,y).call(this,t-1,"forward");t=e===null&&t>0?i(this,s,y).call(this,-1,"forward"):e,t>0&&this.options.anchor.enableDoneState&&this.options.anchor.markPreviousStepsAsDone&&this.steps.slice(0,t).forEach(n=>n.classList.add(this.options.style.anchorDoneCss)),i(this,s,b).call(this,t),i(this,s,C).call(this,"loaded")},P=function(t=!1,e=null){if(this.options.requiredField.active){let n=this.element.querySelectorAll(this.options.requiredField.controls);if(t){if(this.current_index<0)return!1;n=i(this,s,v).call(this,this.current_index).querySelectorAll(this.options.requiredField.controls)}if(n.length>0){let o=[];if(n.forEach(r=>{(r.required||r.classList.contains("required"))&&(typeof this.options.requiredField.functionToValidate=="function"?this.options.requiredField.functionToValidate(r)&&o.push(r):(r.value===""||r.value===void 0||r.value===null)&&o.push(r))}),o.length>0){this.options.requiredField.submitEvent?i(this,s,C).call(this,"requiredErrors",o):o.forEach(h=>{h.classList.add(this.options.requiredField.classInvalid)});let r=i(this,s,G).call(this,o[0]);return r>=0&&(i(this,s,x).call(this,null,"error",!0,r),e!==r&&i(this,s,b).call(this,r)),!0}}}return!1},G=function(t){for(let e=0;e<this.pages.length;e++)if(this.pages[e].contains(t))return e;return-1},M=function(t){this.options.debug&&console.debug("Triggered getFirstDescendant() method...");let e=this.element.querySelector(t);return e||(i(this,s,nt).call(this,`Elemento no encontrado: ${t}`),null)},J=function(){this.options.debug&&console.debug("Triggered getDir() method...");let t=this.element.getAttribute("dir");return t||(t=document.documentElement.getAttribute("dir")||"ltr",this.element.setAttribute("dir",t)),t},Q=function(){this.options.debug&&console.debug("Triggered setElements() method..."),this.element.className="",this.element.classList.add(this.options.style.mainCss,this.options.style.themePrefixCss+this.options.theme),this.element.classList.toggle(this.options.style.justifiedCss,this.options.justified),(this.options.anchor.enableNavigationAlways!==!0||this.options.anchor.enableNavigation!==!0)&&this.steps.forEach(t=>t.classList.add(this.options.style.anchorDefaultCss)),this.options.disabledSteps.forEach(t=>this.steps[t].classList.add(this.options.style.anchorDisabledCss)),this.options.errorSteps.forEach(t=>this.steps[t].classList.add(this.options.style.anchorErrorCss)),this.options.warningSteps.forEach(t=>this.steps[t].classList.add(this.options.style.anchorWarningCss)),this.options.hiddenSteps.forEach(t=>this.steps[t].classList.add(this.options.style.anchorHiddenCss))},m=new WeakMap,L=new WeakMap,E=new WeakMap,w=new WeakMap,S=new WeakMap,D=new WeakMap,X=function(){this.options.debug&&console.debug("Triggered setEvents() method..."),this.steps.forEach(t=>{t.addEventListener("click",p(this,m))}),this.element.addEventListener("click",p(this,L)),document.addEventListener("keyup",p(this,E)),window.addEventListener("hashchange",p(this,w)),window.addEventListener("resize",p(this,S)),this.options.requiredField.checkOnSubmitForm&&(this.searchFormClosest=this.element.closest("form"),this.searchFormClosest&&this.searchFormClosest.addEventListener("submit",p(this,D)))},Y=function(){switch(this.options.debug&&console.debug("Triggered setToolbar() method... type "+this.options.toolbar.position),this.element.querySelectorAll(".sw-toolbar-elm").forEach(t=>t.remove()),this.options.toolbar.position){case"both":this.container.before(i(this,s,A).call(this,"top")),this.container.after(i(this,s,A).call(this,"bottom"));break;case"top":this.container.before(i(this,s,A).call(this,"top"));break;case"bottom":this.container.after(i(this,s,A).call(this,"bottom"));break}},A=function(t){const e=document.createElement("div");e.classList.add("sw-toolbar-elm",this.options.style.toolbarCss,this.options.style.toolbarPrefixCss+t),e.setAttribute("role","toolbar");const n=this.options.toolbar.showNextButton!==!1?Object.assign(document.createElement("button"),{textContent:this.options.lang.next,className:`btn ${this.options.style.btnNextCss} ${this.options.style.btnCss}`,type:"button"}):null,o=this.options.toolbar.showPreviousButton!==!1?Object.assign(document.createElement("button"),{textContent:this.options.lang.previous,className:`btn ${this.options.style.btnPrevCss} ${this.options.style.btnCss}`,type:"button"}):null;return o&&e.appendChild(o),n&&e.appendChild(n),this.options.toolbar.extraHtml&&(e.innerHTML+=this.options.toolbar.extraHtml),e},g=function(t){i(this,s,b).call(this,i(this,s,y).call(this,this.current_index,t))},b=function(t){if(this.options.debug&&console.debug("Triggered showStep() method..."),i(this,s,P).call(this,!0,t))return!1;{if(t===-1||t===null||t===this.current_index||!this.steps[t]||!i(this,s,H).call(this,this.steps[t]))return!1;const e=i(this,s,B).call(this,t);if(this.current_index!==-1&&!i(this,s,C).call(this,"leaveStep",{stepAnchor:i(this,s,j).call(this,this.current_index),stepIndex:this.current_index,stepDirection:e}))return!1;i(this,s,Z).call(this,t,()=>{const n=i(this,s,j).call(this,t);i(this,s,W).call(this,n.getAttribute("href")),i(this,s,tt).call(this,t);const o=i(this,s,v).call(this,this.current_index),r=i(this,s,v).call(this,t);i(this,s,z).call(this,r,o,e,()=>{i(this,s,q).call(this,t),i(this,s,C).call(this,"showStep",{selStep:n,idx:t,stepDirection:e,stepPosition:i(this,s,R).call(this,t)})}),this.current_index=t,i(this,s,st).call(this,t),i(this,s,et).call(this,t)})}},y=function(t,e){let n=null,o;e==="prev"?o=this.steps.slice(0,t).reverse():o=this.steps.slice(t+1);for(let r=0;r<o.length;r++){const h=o[r];if(i(this,s,H).call(this,h)){n=e==="prev"?t-(r+1):r+t+1;break}}return n},_=function(t){if(!i(this,s,H).call(this,t))return!1;const e=t.classList.contains(this.options.style.anchorDoneCss);return this.options.anchor.enableDoneStateNavigation===!1&&e?!1:!(this.options.anchor.enableNavigationAlways===!1&&!e)},H=function(t){return!t.classList.contains(this.options.style.anchorDisabledCss)&&!t.classList.contains(this.options.style.anchorHiddenCss)},B=function(t){return this.current_index<t?"forward":"backward"},R=function(t){return t===0?"first":t===this.steps.length-1?"last":"middle"},j=function(t){return t===null||t===-1?null:this.steps[t]},v=function(t){return t===null||t===-1?null:this.pages[t]},Z=function(t,e){if(typeof this.options.getContent!="function"){e();return}const n=i(this,s,v).call(this,t);if(!n){e();return}const o=i(this,s,B).call(this,t),r=i(this,s,R).call(this,t),h=i(this,s,j).call(this,t);this.options.getContent(t,o,r,h,c=>{c&&(n.innerHTML=c),e()})},z=function(t,e,n,o){const r=p(F,l)[this.options.transition.animation];this.options.debug&&console.debug("Triggered transit() method... "+this.options.transition.animation),typeof r=="function"?r(t,e,n,this,h=>{i(this,s,q).call(this,this.current_index),this.options.debug&&console.debug("Triggered end animation method... "+this.options.transition.animation),h===!1&&(e&&(e.style.display="none"),t.style.display=""),o()}):(e&&(e.style.display="none"),t.style.display="",o())},q=function(t){if(this.options.autoAdjustHeight===!1)return;const e=i(this,s,v).call(this,t).offsetHeight;this.options.debug&&console.debug("Fixed height triggered (Page: "+t+") ... "+e),e>0?this.container.style.height=`${e}px`:this.container.style.height="auto"},tt=function(t){if(this.current_index!==null&&this.current_index>=0){const e=this.steps[this.current_index];e.classList.remove(this.options.style.anchorActiveCss),this.options.anchor.enableDoneState!==!1&&(e.classList.add(this.options.style.anchorDoneCss),this.options.anchor.unDoneOnBackNavigation!==!1&&i(this,s,B).call(this,t)==="backward"&&e.classList.remove(this.options.style.anchorDoneCss))}this.steps[t].classList.remove(this.options.style.anchorDoneCss),this.steps[t].classList.add(this.options.style.anchorActiveCss)},st=function(t){const e=this.element.querySelector(`.${this.options.style.btnNextCss}`),n=this.element.querySelector(`.${this.options.style.btnPrevCss}`);e&&e.classList.remove(this.options.style.anchorDisabledCss),n&&n.classList.remove(this.options.style.anchorDisabledCss);const o=i(this,s,R).call(this,t);if(o==="first"||o==="last"){const r=o==="first"?n:e;r&&r.classList.add(this.options.style.anchorDisabledCss)}else i(this,s,y).call(this,t,"next")===null&&e&&e.classList.add(this.options.style.anchorDisabledCss),i(this,s,y).call(this,t,"prev")===null&&n&&n.classList.add(this.options.style.anchorDisabledCss)},et=function(t){const e=this.nav.offsetWidth,n=e/this.steps.length*(t+1)/e*100;document.documentElement.style.setProperty("--sw-progress-width",`${n}%`),this.progressbar&&(this.progressbar.querySelector(`.${this.options.style.progressBarCss}`).style.width=`${n}%`)},it=function(t){this.options.keyboard.keyNavigation&&(this.options.keyboard.keyLeft.includes(t.which)?(i(this,s,g).call(this,"prev"),t.preventDefault()):this.options.keyboard.keyRight.includes(t.which)&&(i(this,s,g).call(this,"next"),t.preventDefault()))},C=function(t,e){this.options.debug&&console.debug("Triggered triggerEvent() method... "+t),e=e||{},e.wizard=this;const n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0});return this.element.dispatchEvent(n),!n.defaultPrevented},W=function(t){this.options.enableUrlHash&&window.location.hash!==t&&history.pushState(null,null,t)},V=function(){if(this.options.enableUrlHash&&window.location.hash.length>0){const t=this.nav.querySelector(`a[href*='${window.location.hash}']`);if(t)return this.steps.indexOf(t)}return!1},nt=function(t){console.error(t)},x=function(t=null,e,n,o=null){const h={default:this.options.style.anchorDefaultCss,active:this.options.style.anchorActiveCss,done:this.options.style.anchorDoneCss,disable:this.options.style.anchorDisabledCss,hidden:this.options.style.anchorHiddenCss,error:this.options.style.anchorErrorCss,warning:this.options.style.anchorWarningCss}[e];if(h)if(o!==null){const c=this.steps[o]||null;c&&(n?c.classList.add(h):c.classList.remove(h))}else t&&t.forEach(c=>{const u=this.steps[c];n?u.classList.add(h):u.classList.remove(h)})},f(F,l,{fade:(t,e,n,o,r)=>{(e?new Promise(c=>{e.style.transition=`opacity ${o.options.transition.speed/1e3}s ease`,e.style.opacity="0",e.addEventListener("transitionend",()=>{e.style.display="none",e.style.transition="",c()},{once:!0})}):Promise.resolve()).then(()=>{t.style.transition=`opacity ${o.options.transition.speed/1e3}s ease`,t.style.opacity="0",t.style.display="",setTimeout(()=>{t.style.opacity="1",t.addEventListener("transitionend",()=>{t.style.transition="",r()},{once:!0})},50)})},css:(t,e,n,o,r)=>{const h=(d,N,O)=>{if(!N){O();return}const T=()=>{d.classList.remove(N),d.removeEventListener("animationend",T),d.removeEventListener("animationcancel",U),O()},U=()=>{d.classList.remove(N),d.removeEventListener("animationend",T),d.removeEventListener("animationcancel",U),O("cancel")};d.classList.add(N),d.addEventListener("animationend",T),d.addEventListener("animationcancel",U)},c=`${o.options.transition.prefixCss} ${n==="backward"?o.options.transition.bckShowCss:o.options.transition.fwdShowCss}`,u=`${o.options.transition.prefixCss} ${n==="backward"?o.options.transition.bckHideCss:o.options.transition.fwdHideCss}`;e?h(e,u,()=>{e.style.display="none",t.style.display="",h(t,c,()=>{r()})}):(t.style.display="",h(t,c,()=>{r()}))}});let a=F;return a});
